var e=function(e){let t=e,a=()=>{if(t<=0)return!0};return{hit:()=>{!a()&&t--},isSunk:a}},t=function(){let t=new Map,a=0,r=[];return{placeShip:([r,o],n,s)=>{if(a>=5)return{message:"Ready"};let l=[...Array(n)].map((e,t)=>s?[r+t,o]:[r,o+t]);if(l.some(([e,a])=>e<0||e>=10||a<0||a>=10||t.has(`${e},${a}`)))return{message:"Invalid"};let i=e(n);return i.coordinates=l,l.forEach(([e,a])=>{let r=`${e},${a}`;t.set(r,i)}),a++,{coordinates:i.coordinates,message:"Placed"}},deleteShip:([e,r])=>{if(a<=0)return;let o=`${e},${r}`;if(!t.has(o))return;let n=t.get(o);return n.coordinates.forEach(([e,r])=>{let o=`${e},${r}`;t.delete(o),a--}),n.coordinates},clearBoard:()=>{t.clear(),a=0,r.length=[]},receiveAttack:([e,o])=>{var n;if(n=[e,o],r.some(e=>e.length===n.length&&e.every((e,t)=>e===n[t])))return{message:"Made"};let s=`${e},${o}`;if(t.has(s)){r.push([e,o]);let n=t.get(s);return(n.hit(),n.isSunk())?--a<=0?{coordinates:n.coordinates,message:"Lost"}:{coordinates:n.coordinates,message:"Sunk"}:{message:"Hit"}}return r.push([e,o]),{message:"Miss"}},getNumberOfShips:()=>a}},a=function(e){let a=t(),r=([e,t],r,o)=>a.placeShip([e,t],r,o);return{name:e,placeShip:r,deleteShip:([e,t])=>a.deleteShip([e,t]),clearBoard:()=>{a.clearBoard()},receiveAttack:([e,t])=>a.receiveAttack([e,t]),placeShipRandomly:e=>{let t,a=!1;for(;!a;)a="Invalid"!=(t=r([Math.floor(10*Math.random()),Math.floor(10*Math.random())],e,Math.random()>=.5)).message;if("Placed"===t.message)return t.coordinates},getNumberOfShips:()=>a.getNumberOfShips()}},r=function(e,t){let r=a(e),o=a(t),n=r,s=!0,l=!1,i=()=>{s=!0,l=!1},c=()=>{s=!1,l=!0},d=()=>{void 0!==n&&(n=n===r?o:r)},u=()=>s&&void 0!==n?(n.clearBoard(),[5,4,3,3,2].map(e=>n.placeShipRandomly(e)).flat()):void 0;return{getCurrentPlayer:()=>n,toggleCurrentPlayer:d,placeShip:([e,t],a,r)=>{if(s&&void 0!==n&&"AI"!==n.name)return n.placeShip([e,t],a,r)},deleteShip:([e,t])=>{if(s&&void 0!==n)return n.deleteShip([e,t])},placeShipsRandomly:u,attack:([e,t])=>{if(l&&void 0!==n)return(n===r?o:r).receiveAttack([e,t])},finalizeBoard:()=>{if(5!=n.getNumberOfShips())return{message:"Not Full"};d(),"AI"===n.name&&(u(),d()),5===r.getNumberOfShips()&&5===o.getNumberOfShips()&&c()},getGameState:()=>s?"Placing":"Attacking",playAgain:()=>{r.clearBoard(),o.clearBoard(),i(),n=r}}};!function(e,t){let a;let o=r("You","AI"),n=[],s=[],l=0,i=!1,c=document.querySelector(".container1"),d=document.querySelector(".container2"),u=document.querySelector(".endGame"),h=document.querySelector(".endGameText"),m=document.querySelector(".playAgain"),f=document.querySelector("#battleForm"),g=document.querySelector(".boardModal"),p=document.querySelector(".containerModal"),S=document.querySelector(".shipLength"),y=document.querySelector(".random"),v=document.querySelector(".ready"),L=document.querySelector(".rotate");f.addEventListener("submit",e=>{e.preventDefault()}),y.addEventListener("click",function(){k.forEach(e=>e.classList.remove("ship")),w(n=o.placeShipsRandomly(),k).forEach(e=>e.classList.add("ship"))}),v.addEventListener("click",function(){if(!n?.length||5>(a=o.getCurrentPlayer()).getNumberOfShips())return;g.close();let e="You"===a.name?M:E,t=w(n,e);console.log(n),t.forEach(e=>e.classList.add("ship")),o.finalizeBoard()}),L.addEventListener("click",()=>{i=!i,L.classList.toggle("rotated")}),m.addEventListener("click",function(){L.classList.remove("rotated"),document.querySelectorAll(".btnL").forEach(e=>e.disabled=!1),M.forEach(e=>e.classList.remove("hit","miss","ship")),E.forEach(e=>e.classList.remove("hit","miss","ship")),k.forEach(e=>e.classList.remove("ship")),n.length=0,s.length=0,u.close(),g.showModal(),o.playAgain()}),S.addEventListener("click",e=>{let t=e.target;t.dataset.value&&(l=+t.dataset.value)}),p.addEventListener("click",function(e){if(0===l)return;let t=e.target;if(!t.dataset.row)return;if(3!==l&&s.includes(l)){console.log("placed already");return}if(3===l&&2===s.filter(e=>3===e).length){console.log("33333");return}let[a,r]=[t.dataset.row,t.dataset.column],c=o.placeShip([+a,+r],l,i);"Placed"===c.message&&(s.push(l),l&&(document.querySelector(`#ship${l}`).disabled=!0),l=0,w(c.coordinates,k).forEach(e=>e.classList.add("ship")),c.coordinates.forEach(e=>n.push(e)))});let k=b(p);g.showModal();let M=b(c),E=b(d);function b(e){let t=[];return[...Array(10)].forEach((a,r)=>[...Array(10)].forEach((a,o)=>{let n=document.createElement("button");n.classList.add("cell"),n.dataset.row=r,n.dataset.column=o,e.appendChild(n),t.push(n)})),t}d.addEventListener("click",function(e){if(A)return;A=!0;let t=e.target;if(!t.dataset.row||"Made"===q([+t.dataset.row,+t.dataset.column],t)){A=!1;return}if("Lost"!==q){if(o.toggleCurrentPlayer(),"AI"===o.getCurrentPlayer().name){let e="Made";for(;"Made"===e;){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),r=M.find(e=>+e.dataset.row===t&&+e.dataset.column===a);e=q([t,a],r)}o.toggleCurrentPlayer()}A=!1}});let A=!1;function q(e,t){let a=o.attack(e).message;switch(a){case"Hit":t.classList.add("hit"),console.log("Ship hit!");break;case"Miss":t.classList.add("miss"),console.log("Missed the target!");break;case"Made":console.log("Attack been made");break;case"Lost":t.classList.add("hit"),h.textContent=`${o.getCurrentPlayer().name} Win the game`,u.showModal(),console.log("Lost the game!");break;case"Sunk":t.classList.add("hit"),console.log("Ship sunk!")}return a}function w(e,t){return e.map(([e,a])=>t.find(t=>+t.dataset.row===e&&+t.dataset.column===a))}}(0,0);
//# sourceMappingURL=index.d08c71c4.js.map
